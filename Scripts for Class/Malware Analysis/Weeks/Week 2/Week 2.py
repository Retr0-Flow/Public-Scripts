import csv

with open("marathon_results_2017.csv", 'r', newline='') as dataset:  #takes the first 10 lines from the file and stores them as properly formatted lists
    reader = csv.reader(dataset, delimiter=',')
    count = 0
    top_nine = []
    for row in reader:
        #print(row) #debug
        if (count <= 9):
            if (count == 0):
                column_head = row           #saves the first row to it's own variable, this row has all the coloumn headings
            else:
                top_nine.append(row)            #saves the first nine runners as/in a list of lists
        else:
            break
        count+=1
    #print(top_nine) #debug


    zip_list = []
    column_head[0] = 'Postition'
    for record in top_nine:         #creates a list of dictionaries with each runner record being paired with a column head as a key ex. 'Country' : 'USA'
        runner_dict = {}
        zip_list.append(dict(zip(column_head, record))) #sets record[0] = '' for some reason for all records in top_nine when zipped. Hmm...
        for head in column_head:
            #print(head, record[column_head.index(head)]) #debug
            runner_dict[head] = record[column_head.index(head)]
        #zip_list.append(runner_dict)
    runner_dict = {} #clear dict after final record is added to zip_list
    print(zip_list) #debug 



    #Printing runners (Finally lol) created a mold string that will populate the variable based on what runner record is being read and writes the strings to file
    with open(".\\Week 2 Lab Output.Lab", "w") as final_file:
        for runner in zip_list:
            last_first = runner['Name'].split(", ") #splitting Name dict value into a list
            if (runner['State'] != ''):
                text = last_first[1] + " " + last_first[0] + " from " + runner['City'] + ", " + runner["State"] + ", " + runner['Country'] + ", finished with a time of " + runner['Official Time'] + "."
                final_file.write(text + "\n")
            else:
                other_text = last_first[1] + " " + last_first[0] + " from " + runner['City'] + ", "  + runner['Country'] + ", finished with a time of " + runner['Official Time'] + "."
                final_file.write(other_text + "\n")
        final_file.write("hgrewal70576")
        final_file.close()
    dataset.close()
